<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>CiCiå°å§å§</title>
  <meta name="viewport" content="width=device-width,user-scalable=no,minimum-scale=1,maximum-scale=1">
  <link rel="stylesheet" href="css/animate.min.css">

  <!-- ========= è®¡æ—¶å™¨ + æ”¾å¤§é¢„è§ˆ æ ·å¼ ========= -->
  <style>
    /* è®¡æ—¶å™¨ */
    #timer{
      position:fixed;
      top:20px;
      right:20px;
      background:rgba(0,0,0,.55);
      border:1px solid rgba(0,255,255,.6);
      box-shadow:0 0 10px rgba(0,255,255,.8);
      border-radius:8px;
      padding:8px 16px;
      font-family:'Courier New',monospace;
      font-size:18px;
      color:#00ffff;
      letter-spacing:1px;
      z-index:999;
    }
    #since2025{ text-shadow:0 0 4px #0ff,0 0 8px #0ff; }

    /* å³ä¾§æ”¾å¤§é¢„è§ˆ */
    #hoverPreview{
      position:fixed;
      right:-280px;
      top:50%;
      transform:translateY(-50%);
      width:240px;
      background:rgba(0,0,0,.75);
      border:1px solid rgba(0,255,255,.6);
      border-radius:8px;
      padding:12px;
      color:#fff;
      font-size:14px;
      text-align:center;
      box-shadow:0 0 15px rgba(0,255,255,.6);
      transition:right .35s ease;
      z-index:1000;
    }
    #hoverPreview img{
      width:100%;
      border-radius:6px;
      margin-bottom:8px;
    }
    #hoverPreview.show{ right:20px; }

    /* åŸæœ‰æ ·å¼ä¿æŒä¸å˜ */
    html,body{height:100%;}
    body{background:#000;margin:0;font-family:Helvetica,sans-serif;overflow:hidden;}
    #menu{position:absolute;bottom:20px;width:100%;text-align:center;}
    button{color:rgba(127,255,255,.75);background:transparent;border:1px solid rgba(127,255,255,.75);padding:5px 10px;margin:0 4px;cursor:pointer;transition:.3s;}
    button:hover{background:rgba(0,255,255,.5);}
    .element{width:100px;height:100px;box-shadow:0 0 12px rgba(0,255,255,.5);border:1px solid rgba(127,255,255,.25);text-align:center;cursor:pointer;}
    .element:hover{box-shadow:0 0 12px rgba(0,255,255,.75);border-color:rgba(127,255,255,.75);}
    .element img{width:100px;height:100px;}
    .show_info{position:fixed;top:30%;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.6);padding:10px;border-radius:5px;box-shadow:0 0 10px #fff;width:300px;text-align:center;display:none;}
    .show_info img{width:200px;border-radius:5px;}
    .intro{color:#fff;text-indent:20px;margin-top:10px;}

#loveLetter {
  display: none;
  position: fixed;
  left: 20px;
  top: 60px;
  width: 300px;
  background: #f0f0f0; /* æµ…ç°è‰²èƒŒæ™¯ */
  color: #333; /* å­—ä½“é¢œè‰² */
  font-family: 'Courier New', Courier, monospace;
  font-size: 16px;
  line-height: 1.6;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  z-index: 1001;
  transition: opacity 0.5s;
}

#loveLetter.active {
  opacity: 1;
}

.letter-content {
  margin-top: 10px;
}

#closeButton {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
}
  /* ç”Ÿæˆéšæœºé¢œè‰² */
  .line1 { color: #ff69b0; }
  .line2 { color: #9dff0f; }
  .line4 { color: #9dff0f; }

#fireworksCanvas {
  display: none;
  position: fixed;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}

  </style>
</head>

<body>
  <!-- ===== 3D å®¹å™¨ ===== -->
  <div id="container"></div>

<button id="envelopeButton" style="position:fixed; top:10px; left:10px; z-index:1000; padding:10px; background-color:#ff69b0; color:#fff; border:none; border-radius:50%; font-size:20px; cursor:pointer;">ğŸ’Œ</button>

<!-- æƒ…ä¹¦å®¹å™¨ -->
<div id="loveLetter" class="letter" style="display:none; position:fixed; left:20px; top:60px; z-index:1000;">
  <div class="letter-content">
  </div>
  <!-- <button id="closeButton" style="position:absolute; right:10px; top:10px; cursor:pointer; background:none; border:none; font-size:24px;">âœ–</button> -->
</div>

  <!-- ===== éŸ³ä¹ ===== -->
  <audio id="bgm"  loop muted playsinline >
    <source src="./song.mp3" type="audio/mpeg">
  </audio>

  <!-- ===== åº•éƒ¨æŒ‰é’® ===== -->
  <div id="menu">
    <button id="table">ç…§ç‰‡å¢™</button>
    <button id="sphere">æ˜Ÿçƒè§†å›¾</button>
    <button id="helix">èºæ—‹è§†å›¾</button>
    <button id="grid">ç½‘æ ¼è§†å›¾</button>
  </div>

  <!-- ===== è®¡æ—¶å™¨ ===== -->
  <div id="timer">
    <span id="since2025">ç›¸è¯†åŠ è½½ä¸­â€¦</span>
  </div>

  <!-- ===== å³ä¾§æ”¾å¤§é¢„è§ˆ ===== -->
  <div id="hoverPreview">
    <img id="previewImg" src="" alt="">
    <div id="previewTxt" style="color: rebeccapurple">ä»‹ç»åŠ è½½ä¸­â€¦</div>
  </div>

  <!-- ===== ä¸­é—´å¼¹çª—ï¼ˆåŸ show_infoï¼Œä¿ç•™ï¼‰===== -->
  <div class="show_info animated" style="display:none;">
    <div class="info_my">
      <img width="200" src="img/4.png">
    </div>
    <div class="intro">å¤©æ°”å¥½å†·ï¼Œæˆ‘çš„å¿ƒæ˜¯å†°å†°çš„ï¼</div>
  </div>

  <!-- ===== JS åº“ ===== -->
  <script src="js/jquery.min.js"></script>
  <script src="js/three.js"></script>
  <script src="js/tween.min.js"></script>
  <script src="js/TrackballControls.js"></script>
  <script src="js/CSS3DRenderer.js"></script>

  <!-- ===== é¡µé¢è„šæœ¬ ===== -->
  <script>

document.addEventListener('DOMContentLoaded', function () {
	// fire()
  var text = "äº²çˆ±çš„CiCiï¼Œ\nåœ¨è¿™ä¸ªç‰¹åˆ«çš„æ—¥å­é‡Œï¼Œæˆ‘æƒ³å¯¹ä½ è¯´ï¼šä½ æ˜¯æˆ‘ç”Ÿå‘½ä¸­æœ€ç¾ä¸½çš„ç›¸é‡ã€‚\næ¯å½“æˆ‘çœ‹åˆ°ä½ çš„ç¬‘å®¹ï¼Œæˆ‘çš„å¿ƒå°±ä¼šèåŒ–ã€‚\næ„¿æˆ‘ä»¬çš„çˆ±æƒ…åƒè¿™æ˜Ÿç©ºä¸€æ ·ï¼Œæ°¸æ’è€Œç’€ç’¨ã€‚\nçˆ±ä½ çš„ï¼Œ\n[zk]";
  var letter = document.getElementById('loveLetter');
  var currentIndex = 0;

  function typeWriter() {
    if (currentIndex < text.length) {
        var currentChar = text.charAt(currentIndex);
        if (currentChar === '\n') {
            letter.innerHTML += '<br>';
        } else {
            letter.innerHTML += currentChar;
        }
        currentIndex++;
        setTimeout(typeWriter, 100); // è°ƒæ•´é€Ÿåº¦
    }}
  let isshow = false;
  document.getElementById('envelopeButton').addEventListener('click', function() {
	isshow = !isshow
	if(isshow) {
      letter.classList.add('active');
    letter.style.display = 'block';
    typeWriter();
	 
	}else {
		 letter.classList.remove('active');
    setTimeout(() => { letter.style.display = 'none'; }, 500); // å»¶è¿Ÿéšè—ï¼Œä»¥ä¾¿çœ‹åˆ°æ·¡å‡ºæ•ˆæœ
	}
    
  });


})

	const bgm=document.getElementById('bgm');
// å…ˆé™éŸ³æ’­æ”¾ï¼Œæµè§ˆå™¨æ”¾è¡Œ
bgm.play().catch(()=>{});
// ä»»æ„äº¤äº’åè§£é™¤é™éŸ³
['click','keydown','touchstart'].forEach(ev=>{
  document.addEventListener(ev,()=>{
    if(bgm.muted){bgm.muted=false;bgm.play();}
  },{once:true});
});
    /* ---------- 3D ç…§ç‰‡å¢™ ---------- */
    var personArray = [];
    for (var i = 0; i < 199; i++) personArray.push({ image: `img/${Math.floor(Math.random() * 9) + 1}.jpg` });

    var table = [];
    for (var i = 0; i < personArray.length; i++) {
      table[i] = {
        image: personArray[i].image,
        p_x: i % 20 + 1,
        p_y: Math.floor(i / 20) + 1
      };
    }

    var camera, scene, renderer, controls;
    var objects = [];
    var targets = { table: [], sphere: [], helix: [], grid: [] };

    init(); animate();

    function init() {
      camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 1, 10000);
      camera.position.z = 3000;
      scene = new THREE.Scene();

      // ç”Ÿæˆå…ƒç´ 
      for (var i = 0; i < table.length; i++) {
        var element = document.createElement('div');
        element.className = 'element';
        element.style.backgroundColor = 'rgba(0,127,127,' + (Math.random() * .5 + .25) + ')';
        var img = document.createElement('img');
        img.src = table[i].image;
        element.appendChild(img);
        var object = new THREE.CSS3DObject(element);
        object.position.set(Math.random() * 4000 - 2000, Math.random() * 4000 - 2000, Math.random() * 4000 - 2000);
        scene.add(object); objects.push(object);

        var t = new THREE.Object3D();
        t.position.x = (table[i].p_x * 140) - 1330;
        t.position.y = -(table[i].p_y * 180) + 990;
        targets.table.push(t);
      }

      // sphere / helix / grid å¸ƒå±€
      var vec = new THREE.Vector3();
      var sph = new THREE.Spherical();
      for (var i = 0, l = objects.length; i < l; i++) {
        var phi = Math.acos(-1 + (2 * i) / l);
        var theta = Math.sqrt(l * Math.PI) * phi;
        sph.set(800, phi, theta);
        var obj = new THREE.Object3D(); obj.position.setFromSpherical(sph);
        vec.copy(obj.position).multiplyScalar(2); obj.lookAt(vec);
        targets.sphere.push(obj);
      }

      var cyl = new THREE.Cylindrical();
      for (var i = 0, l = objects.length; i < l; i++) {
        var th = i * 0.175 + Math.PI;
        var y = -(i * 5) + 450;
        cyl.set(900, th, y);
        var obj = new THREE.Object3D(); obj.position.setFromCylindrical(cyl);
        vec.set(obj.position.x * 2, obj.position.y, obj.position.z * 2); obj.lookAt(vec);
        targets.helix.push(obj);
      }

      for (var i = 0; i < objects.length; i++) {
        var obj = new THREE.Object3D();
        obj.position.x = ((i % 5) * 400) - 800;
        obj.position.y = (-(Math.floor(i / 5) % 5) * 300) + 500;
        obj.position.z = (Math.floor(i / 25)) * 200 - 800;
        targets.grid.push(obj);
      }

      renderer = new THREE.CSS3DRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.getElementById('container').appendChild(renderer.domElement);

      controls = new THREE.TrackballControls(camera, renderer.domElement);
      controls.rotateSpeed = 0.5; controls.minDistance = 500; controls.maxDistance = 6000;
      controls.addEventListener('change', render);

      ['table','sphere','helix','grid'].forEach(id=>{
        document.getElementById(id).addEventListener('click',()=>transform(targets[id],1000));
      });
      transform(targets.table,2000);

      window.addEventListener('resize', onWindowResize, false);
    }

    function transform(targets, duration) {
      TWEEN.removeAll();
      for (var i = 0; i < objects.length; i++) {
        var object = objects[i], target = targets[i];
        new TWEEN.Tween(object.position)
          .to({ x: target.position.x, y: target.position.y, z: target.position.z }, Math.random() * duration + duration)
          .easing(TWEEN.Easing.Exponential.InOut).start();
        new TWEEN.Tween(object.rotation)
          .to({ x: target.rotation.x, y: target.rotation.y, z: target.rotation.z }, Math.random() * duration + duration)
          .easing(TWEEN.Easing.Exponential.InOut).start();
      }
      new TWEEN.Tween(this).to({}, duration * 2).onUpdate(render).start();
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
      render();
    }

    function animate() {
      requestAnimationFrame(animate);
      scene.rotation.y += 0.008;
      TWEEN.update(); controls.update(); render();
    }

    function render() { renderer.render(scene, camera); }

    /* ---------- è®¡æ—¶å™¨ ---------- */
    function updateSince2025(){
      const start = new Date('2025-02-10T11:54:00');
      const now   = new Date();
      const diff  = now - start;
      const total = Math.floor(diff/1000);
      const sec   = total % 60;
      const min   = Math.floor(total/60)%60;
      const hour  = Math.floor(total/3600)%24;
      const day   = Math.floor(total/86400);
      const pad   = n => n.toString().padStart(2,'0');
      document.getElementById('since2025').textContent =
        `ç›¸è¯† ${day} å¤© ${pad(hour)}:${pad(min)}:${pad(sec)}`;
    }
    updateSince2025(); setInterval(updateSince2025,1000);

    /* ---------- å³ä¾§æ”¾å¤§é¢„è§ˆ ---------- */
    const hoverBox = document.getElementById('hoverPreview');
    const hoverImg = document.getElementById('previewImg');
    const hoverTxt = document.getElementById('previewTxt');
const loveMessages = {
  1: "ä½ æ˜¯æˆ‘å¿ƒä¸­çš„æ¸©æŸ”æœˆå…‰ï¼Œç…§äº®æˆ‘æ‰€æœ‰çš„é»‘æš—ã€‚",
  2: "æ¯æ¬¡æƒ³åˆ°ä½ ï¼Œæˆ‘çš„å¿ƒé‡Œå°±å¼€æ»¡äº†èŠ±ã€‚",
  3: "ä½ çš„å¾®ç¬‘æ˜¯æˆ‘ä¸€å¤©ä¸­æœ€ç¾å¥½çš„äº‹æƒ…ã€‚",
  4: "æˆ‘æ„¿æ„ç”¨æˆ‘æ‰€æœ‰çš„åŠ›é‡æ¥å®ˆæŠ¤ä½ çš„å¾®ç¬‘ã€‚",
  5: "ä½ è®©æˆ‘çš„ä¸–ç•Œå˜å¾—å®Œæ•´ï¼Œè°¢è°¢ä½ çš„å­˜åœ¨ã€‚",
  6: "æ— è®ºæœªæ¥å¦‚ä½•ï¼Œæˆ‘çš„å¿ƒæ°¸è¿œæœ‰ä¸€ä¸ªä½ç½®å±äºä½ ã€‚",
  7: "å’Œä½ åœ¨ä¸€èµ·çš„æ—¶å…‰æ€»æ˜¯è¿‡å¾—å¤ªå¿«ã€‚",
  8: "ä½ è®©æˆ‘ç›¸ä¿¡ï¼Œä¸–ç•Œä¸ŠçœŸçš„æœ‰å¥‡è¿¹ï¼Œé‚£å°±æ˜¯é‡è§ä½ ã€‚",
  9: "æˆ‘çˆ±ä½ ï¼Œä»è¿™é‡Œåˆ°æœˆäº®ï¼Œå†ç»•å›æ¥ã€‚"
};
    const tempLenth = new Set();
    document.addEventListener('mouseover', e=>{
	  if (tempLenth.size === 9) {
		window.alert('ä¿ºæ¬ cc å°å§å§ç¤¼ç‰©ä¸€ä»½ï¼--- zk')
		tempLenth.clear()
	  }
      const el = e.target.closest('.element');
      if(!el) return;
      const img = el.querySelector('img');
      hoverImg.src = img.src;
      hoverTxt.textContent = loveMessages[img.src.slice(-5,-4)];
      hoverBox.classList.add('show');
	  tempLenth.add(img.src.slice(-5,-4));
    });

    document.addEventListener('mouseout', e=>{
      if(e.target.closest('.element')) hoverBox.classList.remove('show');
    });
  </script>
</body>
</html>